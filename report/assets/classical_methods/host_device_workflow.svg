<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 450">
  <!-- Title -->
  <text x="350" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#333">GPU Programming Workflow</text>

  <!-- Host (CPU) side -->
  <g id="host-side">
    <rect x="50" y="60" width="250" height="360" fill="#E3F2FD" stroke="#1976D2" stroke-width="2" rx="8"/>
    <text x="175" y="90" font-size="16" font-weight="bold" text-anchor="middle" fill="#1976D2">Host (CPU)</text>

    <!-- Step 1 -->
    <rect x="70" y="110" width="210" height="50" fill="#4CAF50" stroke="#2E7D32" stroke-width="2" rx="5"/>
    <text x="175" y="130" font-size="12" font-weight="bold" text-anchor="middle" fill="white">1. Allocate Host Memory</text>
    <text x="175" y="148" font-size="10" text-anchor="middle" fill="white">float *h\_a, *h\_b;</text>

    <!-- Step 2 -->
    <rect x="70" y="175" width="210" height="50" fill="#2196F3" stroke="#1565C0" stroke-width="2" rx="5"/>
    <text x="175" y="195" font-size="12" font-weight="bold" text-anchor="middle" fill="white">2. Allocate Device Memory</text>
    <text x="175" y="213" font-size="10" text-anchor="middle" fill="white">cudaMalloc(&amp;d\_a, size);</text>

    <!-- Step 3 -->
    <rect x="70" y="240" width="210" height="50" fill="#FF9800" stroke="#E65100" stroke-width="2" rx="5"/>
    <text x="175" y="260" font-size="12" font-weight="bold" text-anchor="middle" fill="white">3. Copy Data to Device</text>
    <text x="175" y="278" font-size="10" text-anchor="middle" fill="white">cudaMemcpy(HostToDevice)</text>

    <!-- Step 4 -->
    <rect x="70" y="305" width="210" height="50" fill="#9C27B0" stroke="#6A1B9A" stroke-width="2" rx="5"/>
    <text x="175" y="325" font-size="12" font-weight="bold" text-anchor="middle" fill="white">4. Launch Kernel</text>
    <text x="175" y="343" font-size="10" text-anchor="middle" fill="white">kernel$\langle\langle\langle$blocks,threads$\rangle\rangle\rangle$()</text>

    <!-- Step 6 -->
    <rect x="70" y="370" width="210" height="40" fill="#FF5722" stroke="#BF360C" stroke-width="2" rx="5"/>
    <text x="175" y="390" font-size="12" font-weight="bold" text-anchor="middle" fill="white">6. Copy Results Back</text>
    <text x="175" y="403" font-size="10" text-anchor="middle" fill="white">cudaMemcpy(DeviceToHost)</text>
  </g>

  <!-- Device (GPU) side -->
  <g id="device-side">
    <rect x="400" y="60" width="250" height="360" fill="#FFF3E0" stroke="#F57C00" stroke-width="2" rx="8"/>
    <text x="525" y="90" font-size="16" font-weight="bold" text-anchor="middle" fill="#F57C00">Device (GPU)</text>

    <!-- GPU Memory -->
    <rect x="420" y="110" width="210" height="70" fill="#FFE082" stroke="#FFA000" stroke-width="2" rx="5"/>
    <text x="525" y="135" font-size="12" font-weight="bold" text-anchor="middle" fill="#333">Device Memory</text>
    <text x="525" y="155" font-size="10" text-anchor="middle" fill="#666">Global Memory (DRAM)</text>
    <text x="525" y="170" font-size="10" text-anchor="middle" fill="#666">Shared Memory (On-chip)</text>

    <!-- Step 5: Kernel execution -->
    <rect x="420" y="195" width="210" height="150" fill="#7E57C2" stroke="#4527A0" stroke-width="2" rx="5"/>
    <text x="525" y="220" font-size="12" font-weight="bold" text-anchor="middle" fill="white">5. Execute Kernel</text>

    <!-- Thread blocks visualization -->
    <g id="execution">
      <rect x="435" y="235" width="40" height="35" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/>
      <text x="455" y="257" font-size="9" text-anchor="middle" fill="white" font-weight="bold">Block 0</text>

      <rect x="480" y="235" width="40" height="35" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/>
      <text x="500" y="257" font-size="9" text-anchor="middle" fill="white" font-weight="bold">Block 1</text>

      <rect x="525" y="235" width="40" height="35" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/>
      <text x="545" y="257" font-size="9" text-anchor="middle" fill="white" font-weight="bold">Block 2</text>

      <rect x="570" y="235" width="40" height="35" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/>
      <text x="590" y="257" font-size="9" text-anchor="middle" fill="white" font-weight="bold">Block N</text>

      <rect x="435" y="280" width="40" height="35" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/>
      <rect x="480" y="280" width="40" height="35" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/>
      <rect x="525" y="280" width="40" height="35" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/>
      <rect x="570" y="280" width="40" height="35" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/>

      <text x="525" y="330" font-size="10" text-anchor="middle" fill="white">Parallel Execution</text>
    </g>

    <!-- Results -->
    <rect x="420" y="360" width="210" height="50" fill="#66BB6A" stroke="#388E3C" stroke-width="2" rx="5"/>
    <text x="525" y="380" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Computation Results</text>
    <text x="525" y="398" font-size="10" text-anchor="middle" fill="white">Stored in Device Memory</text>
  </g>

  <!-- Arrows showing data flow -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333"/>
    </marker>
  </defs>

  <!-- Arrow: Copy to device -->
  <path d="M 280 265 L 420 145" stroke="#FF9800" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  <text x="340" y="195" font-size="11" fill="#FF9800" font-weight="bold">Data $\rightarrow$</text>

  <!-- Arrow: Launch kernel -->
  <path d="M 280 330 L 420 240" stroke="#9C27B0" stroke-width="3" fill="none" marker-end="url(#arrow)" stroke-dasharray="5,5"/>
  <text x="340" y="275" font-size="11" fill="#9C27B0" font-weight="bold">Launch</text>

  <!-- Arrow: Copy back -->
  <path d="M 420 385 L 280 385" stroke="#FF5722" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  <text x="340" y="375" font-size="11" fill="#FF5722" font-weight="bold">$\leftarrow$ Results</text>
</svg>
