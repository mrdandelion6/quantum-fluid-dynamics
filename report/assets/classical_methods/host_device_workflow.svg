<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 450"><text x="350" y="30" fill="#333" font-size="18" font-weight="bold" text-anchor="middle">GPU Programming Workflow</text><g id="host-side"><rect width="250" height="360" x="50" y="60" fill="#E3F2FD" stroke="#1976D2" stroke-width="2" rx="8"/><text x="175" y="90" fill="#1976D2" font-size="16" font-weight="bold" text-anchor="middle">Host (CPU)</text><rect width="210" height="50" x="70" y="110" fill="#4CAF50" stroke="#2E7D32" stroke-width="2" rx="5"/><text x="175" y="130" fill="#fff" font-size="12" font-weight="bold" text-anchor="middle">1. Allocate Host Memory</text><text x="175" y="148" fill="#fff" font-size="10" text-anchor="middle">float *h\_a, *h\_b;</text><rect width="210" height="50" x="70" y="175" fill="#2196F3" stroke="#1565C0" stroke-width="2" rx="5"/><text x="175" y="195" fill="#fff" font-size="12" font-weight="bold" text-anchor="middle">2. Allocate Device Memory</text><text x="175" y="213" fill="#fff" font-size="10" text-anchor="middle">cudaMalloc(&amp;d\_a, size);</text><rect width="210" height="50" x="70" y="240" fill="#FF9800" stroke="#E65100" stroke-width="2" rx="5"/><text x="175" y="260" fill="#fff" font-size="12" font-weight="bold" text-anchor="middle">3. Copy Data to Device</text><text x="175" y="278" fill="#fff" font-size="10" text-anchor="middle">cudaMemcpy(HostToDevice)</text><rect width="210" height="50" x="70" y="305" fill="#9C27B0" stroke="#6A1B9A" stroke-width="2" rx="5"/><text x="175" y="325" fill="#fff" font-size="12" font-weight="bold" text-anchor="middle">4. Launch Kernel</text><text x="175" y="343" fill="#fff" font-size="10" text-anchor="middle">kernel$\langle\langle\langle$blocks,threads$\rangle\rangle\rangle$()</text><rect width="210" height="40" x="70" y="370" fill="#FF5722" stroke="#BF360C" stroke-width="2" rx="5"/><text x="175" y="390" fill="#fff" font-size="12" font-weight="bold" text-anchor="middle">6. Copy Results Back</text><text x="175" y="403" fill="#fff" font-size="10" text-anchor="middle">cudaMemcpy(DeviceToHost)</text></g><g id="device-side"><rect width="250" height="360" x="400" y="60" fill="#FFF3E0" stroke="#F57C00" stroke-width="2" rx="8"/><text x="525" y="90" fill="#F57C00" font-size="16" font-weight="bold" text-anchor="middle">Device (GPU)</text><rect width="210" height="70" x="420" y="110" fill="#FFE082" stroke="#FFA000" stroke-width="2" rx="5"/><text x="525" y="135" fill="#333" font-size="12" font-weight="bold" text-anchor="middle">Device Memory</text><text x="525" y="155" fill="#666" font-size="10" text-anchor="middle">Global Memory (DRAM)</text><text x="525" y="170" fill="#666" font-size="10" text-anchor="middle">Shared Memory (On-chip)</text><rect width="210" height="150" x="420" y="195" fill="#7E57C2" stroke="#4527A0" stroke-width="2" rx="5"/><text x="525" y="220" fill="#fff" font-size="12" font-weight="bold" text-anchor="middle">5. Execute Kernel</text><g id="execution"><rect width="40" height="35" x="435" y="235" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/><text x="455" y="257" fill="#fff" font-size="9" font-weight="bold" text-anchor="middle">Block 0</text><rect width="40" height="35" x="480" y="235" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/><text x="500" y="257" fill="#fff" font-size="9" font-weight="bold" text-anchor="middle">Block 1</text><rect width="40" height="35" x="525" y="235" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/><text x="545" y="257" fill="#fff" font-size="9" font-weight="bold" text-anchor="middle">Block 2</text><rect width="40" height="35" x="570" y="235" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/><text x="590" y="257" fill="#fff" font-size="9" font-weight="bold" text-anchor="middle">Block N</text><rect width="40" height="35" x="435" y="280" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/><rect width="40" height="35" x="480" y="280" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/><rect width="40" height="35" x="525" y="280" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/><rect width="40" height="35" x="570" y="280" fill="#4CAF50" stroke="#2E7D32" stroke-width="1" rx="2"/><text x="525" y="330" fill="#fff" font-size="10" text-anchor="middle">Parallel Execution</text></g><rect width="210" height="50" x="420" y="360" fill="#66BB6A" stroke="#388E3C" stroke-width="2" rx="5"/><text x="525" y="380" fill="#fff" font-size="12" font-weight="bold" text-anchor="middle">Computation Results</text><text x="525" y="398" fill="#fff" font-size="10" text-anchor="middle">Stored in Device Memory</text></g><defs><marker id="arrow" markerHeight="10" markerWidth="10" orient="auto" refX="9" refY="3"><polygon fill="#333" points="0 0 10 3 0 6"/></marker></defs><path fill="none" stroke="#FF9800" stroke-width="3" marker-end="url(#arrow)" d="M 280 265 L 420 145"/><text x="340" y="195" fill="#FF9800" font-size="11" font-weight="bold">Data $\rightarrow$</text><path fill="none" stroke="#9C27B0" stroke-dasharray="5 5" stroke-width="3" marker-end="url(#arrow)" d="M 280 330 L 420 240"/><text x="340" y="275" fill="#9C27B0" font-size="11" font-weight="bold">Launch</text><path fill="none" stroke="#FF5722" stroke-width="3" marker-end="url(#arrow)" d="M 420 385 L 280 385"/><text x="340" y="375" fill="#FF5722" font-size="11" font-weight="bold">$\leftarrow$ Results</text></svg>